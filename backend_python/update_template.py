import pandas as pd
import os

# สร้าง folder templates ถ้ายังไม่มี
os.makedirs('templates', exist_ok=True)

# สร้างข้อมูลตัวอย่างตามโครงสร้างใหม่ที่มี businessType และ address แบบแยกช่อง
data = [
    {
        'รหัสลูกค้า': 'CUST-001',
        'ประเภทธุรกิจ': 'บริษัทจำกัด',
        'ชื่อลูกค้า': 'บริษัท ตัวอย่าง จำกัด',
        'เลขประจำตัวผู้เสียภาษี': '0123456789012',
        'ที่อยู่': '123 ถนนพระราม 4',
        'แขวง/ตำบล': 'ปทุมวัน',
        'เขต/อำเภอ': 'ปทุมวัน',
        'จังหวัด': 'กรุงเทพมหานคร',
        'รหัสไปรษณีย์': '10330',
        'ชื่อผู้ติดต่อหลัก': 'คุณสมชาย',
        'เบอร์โทร': '081-234-5678',
        'อีเมล': 'info@example.com',
        'ผู้ติดต่อรอง': 'คุณสมหญิง, 082-345-6789',
        'เงื่อนไขการชำระเงิน': 'เครดิต 30 วัน'
    },
    {
        'รหัสลูกค้า': 'CUST-002',
        'ประเภทธุรกิจ': 'ห้างหุ้นส่วน',
        'ชื่อลูกค้า': 'ห้างหุ้นส่วน ABC',
        'เลขประจำตัวผู้เสียภาษี': '',
        'ที่อยู่': '456 ซอยสุขุมวิท 1',
        'แขวง/ตำบล': 'คลองเตย',
        'เขต/อำเภอ': 'คลองเตย',
        'จังหวัด': 'กรุงเทพมหานคร',
        'รหัสไปรษณีย์': '10110',
        'ชื่อผู้ติดต่อหลัก': 'คุณสมศักดิ์',
        'เบอร์โทร': '089-123-4567',
        'อีเมล': '',
        'ผู้ติดต่อรอง': '',
        'เงื่อนไขการชำระเงิน': 'เงินสด'
    }
]

# สร้าง DataFrame
df = pd.DataFrame(data)

# บันทึกเป็น Excel
df.to_excel('templates/customer_template.xlsx', index=False, engine='openpyxl') # type: ignore

print("✅ สร้าง customer_template.xlsx สำเร็จ (อัปเดตโครงสร้างใหม่)")
print("   - เพิ่มคอลัมน์: ประเภทธุรกิจ, แขวง/ตำบล, เขต/อำเภอ, จังหวัด, รหัสไปรษณีย์")
print("   - เพิ่มคอลัมน์: ผู้ติดต่อรอง, เงื่อนไขการชำระเงิน")
